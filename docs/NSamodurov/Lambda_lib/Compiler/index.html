<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Compiler (NSamodurov.Lambda_lib.Compiler)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">NSamodurov</a> &#x00BB; <a href="../index.html">Lambda_lib</a> &#x00BB; Compiler</nav><header class="odoc-preamble"><h1>Module <code><span>Lambda_lib.Compiler</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-op"><a href="#type-op" class="anchor"></a><code><span><span class="keyword">type</span> op</span><span> = </span></code><ol><li id="type-op.Add" class="def variant constructor anchored"><a href="#type-op.Add" class="anchor"></a><code><span>| </span><span><span class="constructor">Add</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>e1 + e2</p><span class="comment-delim">*)</span></div></li><li id="type-op.Sub" class="def variant constructor anchored"><a href="#type-op.Sub" class="anchor"></a><code><span>| </span><span><span class="constructor">Sub</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>e1 - e2</p><span class="comment-delim">*)</span></div></li><li id="type-op.Mul" class="def variant constructor anchored"><a href="#type-op.Mul" class="anchor"></a><code><span>| </span><span><span class="constructor">Mul</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>e1 * e2</p><span class="comment-delim">*)</span></div></li><li id="type-op.Div" class="def variant constructor anchored"><a href="#type-op.Div" class="anchor"></a><code><span>| </span><span><span class="constructor">Div</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>e1 / e2</p><span class="comment-delim">*)</span></div></li><li id="type-op.Less" class="def variant constructor anchored"><a href="#type-op.Less" class="anchor"></a><code><span>| </span><span><span class="constructor">Less</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>e1 &lt; e2</p><span class="comment-delim">*)</span></div></li><li id="type-op.Great" class="def variant constructor anchored"><a href="#type-op.Great" class="anchor"></a><code><span>| </span><span><span class="constructor">Great</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>e1 &gt; e2</p><span class="comment-delim">*)</span></div></li><li id="type-op.LessEq" class="def variant constructor anchored"><a href="#type-op.LessEq" class="anchor"></a><code><span>| </span><span><span class="constructor">LessEq</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>e1 &lt;= e2</p><span class="comment-delim">*)</span></div></li><li id="type-op.GreatEq" class="def variant constructor anchored"><a href="#type-op.GreatEq" class="anchor"></a><code><span>| </span><span><span class="constructor">GreatEq</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>e1 &gt;= e2</p><span class="comment-delim">*)</span></div></li><li id="type-op.Equal" class="def variant constructor anchored"><a href="#type-op.Equal" class="anchor"></a><code><span>| </span><span><span class="constructor">Equal</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>e1 = e2</p><span class="comment-delim">*)</span></div></li><li id="type-op.NeqPhysical" class="def variant constructor anchored"><a href="#type-op.NeqPhysical" class="anchor"></a><code><span>| </span><span><span class="constructor">NeqPhysical</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>e1 != e2</p><span class="comment-delim">*)</span></div></li><li id="type-op.NeqStruct" class="def variant constructor anchored"><a href="#type-op.NeqStruct" class="anchor"></a><code><span>| </span><span><span class="constructor">NeqStruct</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>e1 &lt;&gt; e2</p><span class="comment-delim">*)</span></div></li><li id="type-op.And" class="def variant constructor anchored"><a href="#type-op.And" class="anchor"></a><code><span>| </span><span><span class="constructor">And</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>e1 &amp;&amp; e2</p><span class="comment-delim">*)</span></div></li><li id="type-op.Or" class="def variant constructor anchored"><a href="#type-op.Or" class="anchor"></a><code><span>| </span><span><span class="constructor">Or</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>e1 || e2</p><span class="comment-delim">*)</span></div></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-instr"><a href="#type-instr" class="anchor"></a><code><span><span class="keyword">type</span> instr</span><span> = </span></code><ol><li id="type-instr.Access" class="def variant constructor anchored"><a href="#type-instr.Access" class="anchor"></a><code><span>| </span><span><span class="constructor">Access</span> <span class="keyword">of</span> int</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Access variable</p><span class="comment-delim">*)</span></div></li><li id="type-instr.Cur" class="def variant constructor anchored"><a href="#type-instr.Cur" class="anchor"></a><code><span>| </span><span><span class="constructor">Cur</span> <span class="keyword">of</span> <span><a href="#type-instr">instr</a> list</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Non-tail recursive closure</p><span class="comment-delim">*)</span></div></li><li id="type-instr.Const" class="def variant constructor anchored"><a href="#type-instr.Const" class="anchor"></a><code><span>| </span><span><span class="constructor">Const</span> <span class="keyword">of</span> int</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Put a constant to accumulator</p><span class="comment-delim">*)</span></div></li><li id="type-instr.Primitive" class="def variant constructor anchored"><a href="#type-instr.Primitive" class="anchor"></a><code><span>| </span><span><span class="constructor">Primitive</span> <span class="keyword">of</span> <a href="#type-op">op</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Primitive operators</p><span class="comment-delim">*)</span></div></li><li id="type-instr.BranchIf" class="def variant constructor anchored"><a href="#type-instr.BranchIf" class="anchor"></a><code><span>| </span><span><span class="constructor">BranchIf</span> <span class="keyword">of</span> int</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Jump to specific offset if acc != 0</p><span class="comment-delim">*)</span></div></li><li id="type-instr.Branch" class="def variant constructor anchored"><a href="#type-instr.Branch" class="anchor"></a><code><span>| </span><span><span class="constructor">Branch</span> <span class="keyword">of</span> int</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Unconditional jump</p><span class="comment-delim">*)</span></div></li><li id="type-instr.EndLet" class="def variant constructor anchored"><a href="#type-instr.EndLet" class="anchor"></a><code><span>| </span><span><span class="constructor">EndLet</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>End of let &quot;frame&quot;</p><span class="comment-delim">*)</span></div></li><li id="type-instr.Return" class="def variant constructor anchored"><a href="#type-instr.Return" class="anchor"></a><code><span>| </span><span><span class="constructor">Return</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Return value and get to previous enviroment</p><span class="comment-delim">*)</span></div></li><li id="type-instr.Grab" class="def variant constructor anchored"><a href="#type-instr.Grab" class="anchor"></a><code><span>| </span><span><span class="constructor">Grab</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Get argument from argument stack</p><span class="comment-delim">*)</span></div></li><li id="type-instr.Apply" class="def variant constructor anchored"><a href="#type-instr.Apply" class="anchor"></a><code><span>| </span><span><span class="constructor">Apply</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Apply argument from accumulator</p><span class="comment-delim">*)</span></div></li><li id="type-instr.Let" class="def variant constructor anchored"><a href="#type-instr.Let" class="anchor"></a><code><span>| </span><span><span class="constructor">Let</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Start let &quot;frame&quot;</p><span class="comment-delim">*)</span></div></li><li id="type-instr.Push" class="def variant constructor anchored"><a href="#type-instr.Push" class="anchor"></a><code><span>| </span><span><span class="constructor">Push</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Push argument onto argument stack</p><span class="comment-delim">*)</span></div></li><li id="type-instr.PushMark" class="def variant constructor anchored"><a href="#type-instr.PushMark" class="anchor"></a><code><span>| </span><span><span class="constructor">PushMark</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Same as Push instruction but used first</p><span class="comment-delim">*)</span></div></li><li id="type-instr.AppTerm" class="def variant constructor anchored"><a href="#type-instr.AppTerm" class="anchor"></a><code><span>| </span><span><span class="constructor">AppTerm</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Tail-recursive version of EndLet</p><span class="comment-delim">*)</span></div></li><li id="type-instr.Dummy" class="def variant constructor anchored"><a href="#type-instr.Dummy" class="anchor"></a><code><span>| </span><span><span class="constructor">Dummy</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Push dummy symbol to enviroment</p><span class="comment-delim">*)</span></div></li><li id="type-instr.Update" class="def variant constructor anchored"><a href="#type-instr.Update" class="anchor"></a><code><span>| </span><span><span class="constructor">Update</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Replace the top of the enviroment stack</p><span class="comment-delim">*)</span></div></li><li id="type-instr.Print" class="def variant constructor anchored"><a href="#type-instr.Print" class="anchor"></a><code><span>| </span><span><span class="constructor">Print</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Prints value in accumulator</p><span class="comment-delim">*)</span></div></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compile"><a href="#val-compile" class="anchor"></a><code><span><span class="keyword">val</span> compile : <span><span><a href="../Ast/index.html#type-brujin">Ast.brujin</a> <a href="../Ast/index.html#type-t">Ast.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-instr">instr</a> list</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_instr"><a href="#val-pp_instr" class="anchor"></a><code><span><span class="keyword">val</span> pp_instr : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-instr">instr</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-list_of_apps"><a href="#val-list_of_apps" class="anchor"></a><code><span><span class="keyword">val</span> list_of_apps : <span><span><span class="type-var">'a</span> <a href="../Ast/index.html#type-t">Ast.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../Ast/index.html#type-t">Ast.t</a></span> list</span></span></code></div></div></div></body></html>
